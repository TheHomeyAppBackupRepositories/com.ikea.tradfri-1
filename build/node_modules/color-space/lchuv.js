/**
 * Cylindrical CIE LUV
 *
 * @module color-space/lchuv
 */

'use strict';

const luv = require('./luv');
const xyz = require('./xyz');

// cylindrical luv
var lchuv = module.exports = {
  name: 'lchuv',
  channel: ['lightness', 'chroma', 'hue'],
  alias: ['LCHuv', 'cielchuv'],
  min: [0, 0, 0],
  max: [100, 100, 360],

  luv(luv) {
    const l = luv[0];
    const c = luv[1];
    const h = luv[2];
    let u; let v; let
      hr;

    hr = h / 360 * 2 * Math.PI;
    u = c * Math.cos(hr);
    v = c * Math.sin(hr);
    return [l, u, v];
  },

  xyz(arg) {
    return luv.xyz(lchuv.luv(arg));
  },
};

luv.lchuv = function(luv) {
  const l = luv[0]; const u = luv[1]; const
    v = luv[2];

  const c = Math.sqrt(u * u + v * v);
  const hr = Math.atan2(v, u);
  let h = hr * 360 / 2 / Math.PI;
  if (h < 0) {
    h += 360;
  }

  return [l, c, h];
};

xyz.lchuv = function(arg) {
  return luv.lchuv(xyz.luv(arg));
};
